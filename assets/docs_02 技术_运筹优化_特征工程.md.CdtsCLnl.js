import{_ as s,c as a,o as n,a4 as e}from"./chunks/framework.4aTu-Nia.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"docs/02 技术/运筹优化/特征工程.md","filePath":"docs/02 技术/运筹优化/特征工程.md"}'),p={name:"docs/02 技术/运筹优化/特征工程.md"},t=e(`<h2 id="一、分类特征" tabindex="-1">一、分类特征 <a class="header-anchor" href="#一、分类特征" aria-label="Permalink to &quot;一、分类特征&quot;">​</a></h2><p>1、有序分类特征（保留顺序信息）</p><p>采用有序编码 + 可选频次权重</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>difficulty_map = {&#39;简单&#39;: 1, &#39;中等&#39;: 2, &#39;困难&#39;: 3}</span></span>
<span class="line"><span>data[&#39;exam_difficulty&#39;] = data[&#39;exam_difficulty&#39;].map(difficulty_map)</span></span></code></pre></div><p>2、无序分类特征-低基数</p><p>采用 <strong>One-Hot Encoding</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span># 保留原表结构，避免信息丢失</span></span>
<span class="line"><span>data = pd.get_dummies(data, columns=[&#39;gender&#39;, &#39;course&#39;, &#39;internet_access&#39;, &#39;study_method&#39;], drop_first=True)</span></span></code></pre></div><p>3、无序分类特征-高基数</p><p>采用 <strong>Target Encoding</strong> 或 <strong>Embedding</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>from category_encoders import TargetEncoder </span></span>
<span class="line"><span>course_te = TargetEncoder(cols=[&#39;course&#39;], smoothing=20, min_samples_leaf=100) course_te.fit(X_train, y_train) </span></span>
<span class="line"><span>X_train = course_te.transform(X_train) </span></span>
<span class="line"><span>X_test = course_te.transform(X_test)</span></span></code></pre></div><h2 id="二、数值特征" tabindex="-1">二、数值特征 <a class="header-anchor" href="#二、数值特征" aria-label="Permalink to &quot;二、数值特征&quot;">​</a></h2><p>1、对数转化</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>data[&#39;study_hours_log&#39;] = np.log1p(data[&#39;study_hours&#39;])</span></span></code></pre></div><p>适用场景：长尾</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>import seaborn as sns</span></span>
<span class="line"><span>sns.histplot(data[&#39;study_hours&#39;], kde=True)</span></span>
<span class="line"><span>plt.title(&quot;学习时长分布&quot;)</span></span>
<span class="line"><span>plt.show()</span></span></code></pre></div><p>2、标准化/归一化</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>from sklearn.preprocessing import StandardScaler</span></span>
<span class="line"><span>scaler = StandardScaler()</span></span>
<span class="line"><span>numeric_cols = [&#39;study_hours&#39;, &#39;class_attendance&#39;, &#39;sleep_hours&#39;, &#39;age&#39;]</span></span>
<span class="line"><span>data[numeric_cols] = scaler.fit_transform(data[numeric_cols])</span></span></code></pre></div><p>适用场景：XGBoost、LightGBM、神经网络等模型</p><h2 id="三、构造新特征" tabindex="-1">三、构造新特征 <a class="header-anchor" href="#三、构造新特征" aria-label="Permalink to &quot;三、构造新特征&quot;">​</a></h2><table><thead><tr><th>新特征</th><th>说明</th><th>公式</th></tr></thead><tbody><tr><td><code>study_efficiency</code></td><td>学习效率 = 成绩 / 学习时长</td><td><code>exam_score / (study_hours + 1)</code></td></tr><tr><td><code>sleep_efficiency</code></td><td>睡眠效率 = 成绩 / 睡眠时间</td><td><code>exam_score / (sleep_hours + 1)</code></td></tr><tr><td><code>study_sleep_ratio</code></td><td>学习 vs 睡眠比例</td><td><code>study_hours / sleep_hours</code></td></tr><tr><td><code>age_group</code></td><td>年龄分组（如 15-17, 18-20）</td><td><code>pd.cut(data[&#39;age&#39;], bins=[15,17,19,21])</code></td></tr></tbody></table><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>data[&#39;study_efficiency&#39;] = data[&#39;exam_score&#39;] / (data[&#39;study_hours&#39;] + 1) data[&#39;sleep_efficiency&#39;] = data[&#39;exam_score&#39;] / (data[&#39;sleep_hours&#39;] + 1) data[&#39;study_sleep_ratio&#39;] = data[&#39;study_hours&#39;] / (data[&#39;sleep_hours&#39;] + 1)</span></span></code></pre></div><p>这些特征能捕捉“学习是否高效”、“睡眠是否影响成绩”等深层关系</p><h2 id="四、处理异常值" tabindex="-1">四、处理异常值 <a class="header-anchor" href="#四、处理异常值" aria-label="Permalink to &quot;四、处理异常值&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span># 使用 IQR 法检测异常值</span></span>
<span class="line"><span>Q1 = data[&#39;study_hours&#39;].quantile(0.25)</span></span>
<span class="line"><span>Q3 = data[&#39;study_hours&#39;].quantile(0.75)</span></span>
<span class="line"><span>IQR = Q3 - Q1</span></span>
<span class="line"><span>lower = Q1 - 1.5 * IQR</span></span>
<span class="line"><span>upper = Q3 + 1.5 * IQR</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 限制范围（截断）</span></span>
<span class="line"><span>data[&#39;study_hours&#39;] = data[&#39;study_hours&#39;].clip(lower=lower, upper=upper)</span></span></code></pre></div><h2 id="五、平滑" tabindex="-1">五、平滑 <a class="header-anchor" href="#五、平滑" aria-label="Permalink to &quot;五、平滑&quot;">​</a></h2><h2 id="六、交叉特征" tabindex="-1">六、交叉特征 <a class="header-anchor" href="#六、交叉特征" aria-label="Permalink to &quot;六、交叉特征&quot;">​</a></h2><h2 id="五、特征重要性分析" tabindex="-1">五、特征重要性分析 <a class="header-anchor" href="#五、特征重要性分析" aria-label="Permalink to &quot;五、特征重要性分析&quot;">​</a></h2><p>随机森林</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>from sklearn.ensemble import RandomForestRegressor</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 用随机森林初步评估特征重要性</span></span>
<span class="line"><span>X = data.drop(columns=[&#39;exam_score&#39;])</span></span>
<span class="line"><span>y = data[&#39;exam_score&#39;]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rf = RandomForestRegressor(n_estimators=100, random_state=42)</span></span>
<span class="line"><span>rf.fit(X, y)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 查看重要性</span></span>
<span class="line"><span>importances = pd.DataFrame({</span></span>
<span class="line"><span>    &#39;feature&#39;: X.columns,</span></span>
<span class="line"><span>    &#39;importance&#39;: rf.feature_importances_</span></span>
<span class="line"><span>}).sort_values(&#39;importance&#39;, ascending=False)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>print(importances.head(10))</span></span></code></pre></div><p>lightgbm</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>from lightgbm import LGBMRegressor</span></span>
<span class="line"><span>model = LGBMRegressor(n_estimators=1000, learning_rate=0.05, max_depth=6, subsample=0.8, colsample_bytree=0.8)</span></span>
<span class="line"><span>model.fit(X_train, y_train, eval_set=[(X_test, y_test)], early_stopping_rounds=100, verbose=0)</span></span>
<span class="line"><span>print(&#39;R2 =&#39;, model.score(X_test, y_test))</span></span></code></pre></div><h2 id="六、可解释性" tabindex="-1">六、可解释性 <a class="header-anchor" href="#六、可解释性" aria-label="Permalink to &quot;六、可解释性&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>import shap</span></span>
<span class="line"><span>explainer = shap.TreeExplainer(model)</span></span>
<span class="line"><span>shap.summary_plot(explainer(X_test), X_test)</span></span></code></pre></div>`,33),l=[t];function i(o,c,d,r,h,u){return n(),a("div",null,l)}const m=s(p,[["render",i]]);export{g as __pageData,m as default};
